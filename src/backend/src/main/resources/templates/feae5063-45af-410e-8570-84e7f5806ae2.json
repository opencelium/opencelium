{"templateId":"feae5063-45af-410e-8570-84e7f5806ae2","name":"idoit.create/update","description":"Create/update an object. The fields hostname and ipv4_address are used for the import. All objects are created as a “virtual server” object. If the object already exist, the host is updated. The identifier field is a hostname and it is matched with the hostname field in i-doit.","connection":{"title":"zabbix.idoit.create/update","description":"","fromConnector":{"connectorId":24,"invoker":{"name":"zabbix","links":[]},"methods":[{"nodeId":null,"index":"0","name":"host.get","color":"#FFCFB5","request":{"nodeId":null,"endpoint":"{url}/objects/hosts","method":"POST","header":null,"body":{"method":"host.get","auth":"{token}","id":"1","jsonrpc":"2.0","params":{"output":["hostid","host","status"],"filter":{"host":[]},"selectInterfaces":["interfaceid","ip"]}},"links":[]},"response":{"nodeId":null,"name":"response","success":{"nodeId":null,"status":"200","header":null,"body":{"result":[{"ipmi_privilege":"","maintenance_status":"","jmx_available":"","errors_from":"","tls_psk_identity":"","available":"","snmp_errors_from":"","flags":"","hostid":"","description":"","tls_issuer":"","error":"","jmx_errors_from":"","auto_compress":"","proxy_hostid":"","maintenanceid":"","maintenance_from":"","ipmi_authtype":"","ipmi_username":"","snmp_disable_until":"","host":"","tls_psk":"","jmx_error":"","jmx_disable_until":"","interfaces":[{"ip":"","interfaceid":""}],"disable_until":"","ipmi_errors_from":"","snmp_error":"","proxy_address":"","maintenance_type":"","tls_accept":"","snmp_available":"","templateid":"","ipmi_available":"","lastaccess":"","ipmi_password":"","ipmi_error":"","name":"","tls_connect":"","ipmi_disable_until":"","tls_subject":"","status":""}]},"links":[]},"fail":{"nodeId":null,"status":"400","header":null,"body":null,"links":[]},"links":[]},"links":[]}],"operators":[],"links":[]},"toConnector":{"connectorId":27,"invoker":{"name":"i-doit","links":[]},"methods":[{"nodeId":null,"index":"0_0","name":"cmdb.objects.read","color":"#C77E7E","request":{"nodeId":null,"endpoint":"{url}","method":"POST","header":null,"body":{"method":"cmdb.objects.read","id":"1","params":{"filter":{"ids":[],"title":"#FFCFB5.(response).success.result[].host","type":["59"]},"apikey":"{apikey}"},"version":"2.0"},"links":[]},"response":{"nodeId":null,"name":"response","success":{"nodeId":null,"status":"200","header":null,"body":{"result":[{"cmdb_status_title":"","image":"","sysid":"","created":"","type_title":"","id":"","cmdb_status":"","title":"","type":"","updated":"","type_group_title":"","status":""}],"id":"","jsonrpc":""},"links":[]},"fail":{"nodeId":null,"status":"200","header":null,"body":{"error":{"code":"","data":"","message":""}},"links":[]},"links":[]},"links":[]},{"nodeId":null,"index":"0_1_0","name":"cmdb.object.create","color":"#6477AB","request":{"nodeId":null,"endpoint":"{url}","method":"POST","header":null,"body":{"method":"cmdb.object.create","id":"1","params":{"apikey":"{apikey}","cmdb_status":"#FFCFB5.(response).success.result[].status","type":"C__OBJTYPE__VIRTUAL_SERVER","title":"#FFCFB5.(response).success.result[].host"},"version":"2.0"},"links":[]},"response":{"nodeId":null,"name":"response","success":{"nodeId":null,"status":"200","header":null,"body":{"result":{"id":"","message":"","status":""},"id":"","jsonrpc":""},"links":[]},"fail":{"nodeId":null,"status":"200","header":null,"body":{"error":{"code":"","data":"","message":""}},"links":[]},"links":[]},"links":[]},{"nodeId":null,"index":"0_1_1_0","name":"cmdb.category.create","color":"#98BEC7","request":{"nodeId":null,"endpoint":"{url}","method":"POST","header":null,"body":{"method":"cmdb.category.create","id":"1","params":{"data":{"hostname":"#FFCFB5.(response).success.result[].host","ipv4_address":"#FFCFB5.(response).success.result[].interfaces[]","primary":"1"},"apikey":"{apikey}","objID":"#6477AB.(response).success.result.id","category":"C__CATG__IP"},"version":"2.0"},"links":[]},"response":{"nodeId":null,"name":"response","success":{"nodeId":null,"status":"200","header":null,"body":{"result":[{"id":"","message":""}]},"links":[]},"fail":{"nodeId":null,"status":"200","header":null,"body":{"error":{"code":"","data":"","message":""}},"links":[]},"links":[]},"links":[]},{"nodeId":null,"index":"0_2_0","name":"cmdb.category.update","color":"#9EC798","request":{"nodeId":null,"endpoint":"{url}","method":"POST","header":null,"body":{"method":"cmdb.category.update","id":"1","params":{"apikey":"{apikey}","category":"C__CATG__GLOBAL","data":{"cmdb_status":"#FFCFB5.(response).success.result[].status"},"objID":"#C77E7E.(response).success.result[]"},"version":"2.0"},"links":[]},"response":{"nodeId":null,"name":"response","success":{"nodeId":null,"status":"200","header":null,"body":{"result":[{"hostname":"","objID":"","id":""}]},"links":[]},"fail":{"nodeId":null,"status":"200","header":null,"body":{"error":{"code":"","data":"","message":""}},"links":[]},"links":[]},"links":[]}],"operators":[{"nodeId":null,"type":"loop","index":"0","condition":{"relationalOperator":"","leftStatement":{"color":"#FFCFB5","field":"success.result[]","type":"response","rightPropertyValue":"","links":[]},"rightStatement":null,"links":[]},"links":[]},{"nodeId":null,"type":"if","index":"0_1","condition":{"relationalOperator":"IsEmpty","leftStatement":{"color":"#C77E7E","field":"success.result[]","type":"response","rightPropertyValue":"","links":[]},"rightStatement":null,"links":[]},"links":[]},{"nodeId":null,"type":"if","index":"0_1_1","condition":{"relationalOperator":"=","leftStatement":{"color":"#6477AB","field":"success.result.message","type":"response","rightPropertyValue":"","links":[]},"rightStatement":{"color":"","field":"Object was successfully created","type":"","rightPropertyValue":"","links":[]},"links":[]},"links":[]},{"nodeId":null,"type":"if","index":"0_2","condition":{"relationalOperator":"NotEmpty","leftStatement":{"color":"#C77E7E","field":"success.result[]","type":"response","rightPropertyValue":"","links":[]},"rightStatement":null,"links":[]},"links":[]}],"links":[]},"fieldBinding":[{"from":[{"color":"#FFCFB5","type":"response","field":"success.result[].host","links":[]}],"enhancement":{"enhanceId":null,"name":"","description":"","expertCode":"RESULT_VAR = VAR_0;","expertVar":"//var RESULT_VAR = #C77E7E.(request).params.filter.title;\n//var VAR_0 = #FFCFB5.(response).success.result[].host;","simpleCode":null,"language":"js","links":[]},"to":[{"color":"#C77E7E","type":"request","field":"params.filter.title","links":[]}],"links":[]},{"from":[{"color":"#FFCFB5","type":"response","field":"success.result[].status","links":[]}],"enhancement":{"enhanceId":null,"name":"","description":"","expertCode":"RESULT_VAR = 6;\nif(VAR_0 != \"0\"){\n  RESULT_VAR = 10;\n}","expertVar":"//var RESULT_VAR = #6477AB.(request).params.cmdb_status;\n//var VAR_0 = #FFCFB5.(response).success.result[].status;","simpleCode":null,"language":"js","links":[]},"to":[{"color":"#6477AB","type":"request","field":"params.cmdb_status","links":[]}],"links":[]},{"from":[{"color":"#FFCFB5","type":"response","field":"success.result[].host","links":[]}],"enhancement":{"enhanceId":null,"name":"","description":"","expertCode":"RESULT_VAR = VAR_0;","expertVar":"//var RESULT_VAR = #6477AB.(request).params.title;\n//var VAR_0 = #FFCFB5.(response).success.result[].host;","simpleCode":null,"language":"js","links":[]},"to":[{"color":"#6477AB","type":"request","field":"params.title","links":[]}],"links":[]},{"from":[{"color":"#6477AB","type":"response","field":"success.result.id","links":[]}],"enhancement":{"enhanceId":null,"name":"","description":"","expertCode":"RESULT_VAR = VAR_0;","expertVar":"//var RESULT_VAR = #98BEC7.(request).params.objID;\n//var VAR_0 = #6477AB.(response).success.result.id;","simpleCode":null,"language":"js","links":[]},"to":[{"color":"#98BEC7","type":"request","field":"params.objID","links":[]}],"links":[]},{"from":[{"color":"#FFCFB5","type":"response","field":"success.result[].host","links":[]}],"enhancement":{"enhanceId":null,"name":"","description":"","expertCode":"RESULT_VAR = VAR_0;","expertVar":"//var RESULT_VAR = #98BEC7.(request).params.data.hostname;\n//var VAR_0 = #FFCFB5.(response).success.result[].host;","simpleCode":null,"language":"js","links":[]},"to":[{"color":"#98BEC7","type":"request","field":"params.data.hostname","links":[]}],"links":[]},{"from":[{"color":"#FFCFB5","type":"response","field":"success.result[].interfaces[]","links":[]}],"enhancement":{"enhanceId":null,"name":"","description":"","expertCode":"RESULT_VAR = VAR_0[0].ip;","expertVar":"//var RESULT_VAR = #98BEC7.(request).params.data.ipv4_address;\n//var VAR_0 = #FFCFB5.(response).success.result[].interfaces[];","simpleCode":null,"language":"js","links":[]},"to":[{"color":"#98BEC7","type":"request","field":"params.data.ipv4_address","links":[]}],"links":[]},{"from":[{"color":"#FFCFB5","type":"response","field":"success.result[].status","links":[]}],"enhancement":{"enhanceId":null,"name":"test","description":"","expertCode":"RESULT_VAR = 6;\nif(VAR_0 != \"0\"){\n  RESULT_VAR = 10;\n}","expertVar":"//var RESULT_VAR = #9EC798.(request).params.data.cmdb_status;\n//var VAR_0 = #FFCFB5.(response).success.result[].status;","simpleCode":null,"language":"js","links":[]},"to":[{"color":"#9EC798","type":"request","field":"params.data.cmdb_status","links":[]}],"links":[]},{"from":[{"color":"#C77E7E","type":"response","field":"success.result[]","links":[]}],"enhancement":{"enhanceId":null,"name":"","description":"","expertCode":"RESULT_VAR =VAR_0[0].id;","expertVar":"//var RESULT_VAR = #9EC798.(request).params.objID;\n//var VAR_0 = #C77E7E.(response).success.result[];","simpleCode":null,"language":"js","links":[]},"to":[{"color":"#9EC798","type":"request","field":"params.objID","links":[]}],"links":[]}],"links":[]}}
